"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[579],{76:(N,M,u)=>{u.d(M,{GW:()=>r,dk:()=>_,oK:()=>l});var l=(()=>((l=l||{}).Prompt="PROMPT",l.Camera="CAMERA",l.Photos="PHOTOS",l))(),r=(()=>((r=r||{}).Rear="REAR",r.Front="FRONT",r))(),_=(()=>((_=_||{}).Uri="uri",_.Base64="base64",_.DataUrl="dataUrl",_))()},7423:(N,M,u)=>{u.d(M,{Uw:()=>h,fo:()=>Y,xz:()=>E});var l=u(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var g=(()=>((g=g||{}).Unimplemented="UNIMPLEMENTED",g.Unavailable="UNAVAILABLE",g))();class E extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const x=n=>{var e,t,i,c,o;const d=n.CapacitorCustomPlatform||null,s=n.Capacitor||{},y=s.Plugins=s.Plugins||{},f=n.CapacitorPlatforms,z=(null===(e=null==f?void 0:f.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==d?d.name:(n=>{var e,t;return null!=n&&n.androidBridge?"android":null!==(t=null===(e=null==n?void 0:n.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(n)),ce=(null===(t=null==f?void 0:f.currentPlatform)||void 0===t?void 0:t.isNativePlatform)||(()=>"web"!==z()),de=(null===(i=null==f?void 0:f.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(b=>{const P=ee.get(b);return!!(null!=P&&P.platforms.has(z())||ae(b))}),ae=(null===(c=null==f?void 0:f.currentPlatform)||void 0===c?void 0:c.getPluginHeader)||(b=>{var P;return null===(P=s.PluginHeaders)||void 0===P?void 0:P.find(K=>K.name===b)}),ee=new Map,pe=(null===(o=null==f?void 0:f.currentPlatform)||void 0===o?void 0:o.registerPlugin)||((b,P={})=>{const K=ee.get(b);if(K)return console.warn(`Capacitor plugin "${b}" already registered. Cannot register plugins twice.`),K.proxy;const F=z(),J=ae(b);let I;const ve=function(){var w=(0,l.Z)(function*(){return!I&&F in P?I=I="function"==typeof P[F]?yield P[F]():P[F]:null!==d&&!I&&"web"in P&&(I=I="function"==typeof P.web?yield P.web():P.web),I});return function(){return w.apply(this,arguments)}}(),te=w=>{let O;const U=(...R)=>{const $=ve().then(T=>{const G=((w,O)=>{var U,R;if(!J){if(w)return null===(R=w[O])||void 0===R?void 0:R.bind(w);throw new E(`"${b}" plugin is not implemented on ${F}`,g.Unimplemented)}{const $=null==J?void 0:J.methods.find(T=>O===T.name);if($)return"promise"===$.rtype?T=>s.nativePromise(b,O.toString(),T):(T,G)=>s.nativeCallback(b,O.toString(),T,G);if(w)return null===(U=w[O])||void 0===U?void 0:U.bind(w)}})(T,w);if(G){const X=G(...R);return O=null==X?void 0:X.remove,X}throw new E(`"${b}.${w}()" is not implemented on ${F}`,g.Unimplemented)});return"addListener"===w&&($.remove=(0,l.Z)(function*(){return O()})),$};return U.toString=()=>`${w.toString()}() { [capacitor code] }`,Object.defineProperty(U,"name",{value:w,writable:!1,configurable:!1}),U},se=te("addListener"),le=te("removeListener"),Pe=(w,O)=>{const U=se({eventName:w},O),R=function(){var T=(0,l.Z)(function*(){const G=yield U;le({eventName:w,callbackId:G},O)});return function(){return T.apply(this,arguments)}}(),$=new Promise(T=>U.then(()=>T({remove:R})));return $.remove=(0,l.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield R()}),$},re=new Proxy({},{get(w,O){switch(O){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return J?Pe:se;case"removeListener":return le;default:return te(O)}}});return y[b]=re,ee.set(b,{name:b,proxy:re,platforms:new Set([...Object.keys(P),...J?[F]:[]])}),re});return s.convertFileSrc||(s.convertFileSrc=b=>b),s.getPlatform=z,s.handleError=b=>n.console.error(b),s.isNativePlatform=ce,s.isPluginAvailable=de,s.pluginMethodNoop=(b,P,K)=>Promise.reject(`${K} does not have an implementation of "${P}".`),s.registerPlugin=pe,s.Exception=E,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s.platform=s.getPlatform(),s.isNative=s.isNativePlatform(),s},Z=(n=>n.Capacitor=x(n))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Y=Z.registerPlugin;class h{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){var i=this;this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o);const d=function(){var y=(0,l.Z)(function*(){return i.removeListener(e,t)});return function(){return y.apply(this,arguments)}}(),s=Promise.resolve({remove:d});return Object.defineProperty(s,"remove",{value:(y=(0,l.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield d()}),function(){return y.apply(this,arguments)})}),s;var y}removeAllListeners(){var e=this;return(0,l.Z)(function*(){e.listeners={};for(const t in e.windowListeners)e.removeWindowListener(e.windowListeners[t]);e.windowListeners={}})()}notifyListeners(e,t){const i=this.listeners[e];i&&i.forEach(c=>c(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new Z.Exception(e,g.Unimplemented)}unavailable(e="not available"){return new Z.Exception(e,g.Unavailable)}removeListener(e,t){var i=this;return(0,l.Z)(function*(){const c=i.listeners[e];if(!c)return;const o=c.indexOf(t);i.listeners[e].splice(o,1),i.listeners[e].length||i.removeWindowListener(i.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const a=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),v=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class L extends h{getCookies(){return(0,l.Z)(function*(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[c,o]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=v(c).trim(),o=v(o).trim(),t[c]=o}),t})()}setCookie(e){return(0,l.Z)(function*(){try{const t=a(e.key),i=a(e.value),c=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),d=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${c}; path=${o}; ${d};`}catch(t){return Promise.reject(t)}})()}deleteCookie(e){return(0,l.Z)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})()}clearCookies(){return(0,l.Z)(function*(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,l.Z)(function*(){try{yield e.clearCookies()}catch(t){return Promise.reject(t)}})()}}Y("CapacitorCookies",{web:()=>new L});const W=function(){var n=(0,l.Z)(function*(e){return new Promise((t,i)=>{const c=new FileReader;c.onload=()=>{const o=c.result;t(o.indexOf(",")>=0?o.split(",")[1]:o)},c.onerror=o=>i(o),c.readAsDataURL(e)})});return function(t){return n.apply(this,arguments)}}();class ie extends h{request(e){return(0,l.Z)(function*(){const t=((n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),c=((n={})=>{const e=Object.keys(n);return Object.keys(n).map(c=>c.toLocaleLowerCase()).reduce((c,o,d)=>(c[o]=n[e[d]],c),{})})(n.headers)["content-type"]||"";if("string"==typeof n.data)t.body=n.data;else if(c.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[d,s]of Object.entries(n.data||{}))o.set(d,s);t.body=o.toString()}else if(c.includes("multipart/form-data")){const o=new FormData;if(n.data instanceof FormData)n.data.forEach((s,y)=>{o.append(y,s)});else for(const s of Object.keys(n.data))o.append(s,n.data[s]);t.body=o;const d=new Headers(t.headers);d.delete("content-type"),t.headers=d}else(c.includes("application/json")||"object"==typeof n.data)&&(t.body=JSON.stringify(n.data));return t})(e,e.webFetchExtra),i=((n,e=!0)=>n?Object.entries(n).reduce((i,c)=>{const[o,d]=c;let s,y;return Array.isArray(d)?(y="",d.forEach(f=>{s=e?encodeURIComponent(f):f,y+=`${o}=${s}&`}),y.slice(0,-1)):(s=e?encodeURIComponent(d):d,y=`${o}=${s}`),`${i}&${y}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),c=i?`${e.url}?${i}`:e.url,o=yield fetch(c,t),d=o.headers.get("content-type")||"";let y,f,{responseType:s="text"}=o.ok?e:{};switch(d.includes("application/json")&&(s="json"),s){case"arraybuffer":case"blob":f=yield o.blob(),y=yield W(f);break;case"json":y=yield o.json();break;default:y=yield o.text()}const Q={};return o.headers.forEach((z,q)=>{Q[q]=z}),{data:y,headers:Q,status:o.status,url:o.url}})()}get(e){var t=this;return(0,l.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var t=this;return(0,l.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var t=this;return(0,l.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var t=this;return(0,l.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var t=this;return(0,l.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}Y("CapacitorHttp",{web:()=>new ie})},3676:(N,M,u)=>{u.d(M,{q:()=>oe});var l=u(5861),r=u(2223),_=u(5559),k=u(7423),C=u(76);const B=(0,k.fo)("Camera",{web:()=>u.e(3954).then(u.bind(u,3954)).then(h=>new h.CameraWeb)});var m=u(8746),g=u(377);let E=(()=>{class h{constructor(a){this.storage=a,this.photos=[]}addNewToGallery(){var a=this;return(0,l.Z)(function*(){const v=yield B.getPhoto({resultType:C.dk.Uri,source:C.oK.Camera,quality:100});a.photos.unshift({filepath:`${(new Date).getTime()}.jpg`,webviewPath:v.webPath})})()}uploadImage(a,v,L){return new Promise(D=>{const A=this.storage.ref(v+"/"+L);A.put(a).snapshotChanges().pipe((0,m.x)(()=>{A.getDownloadURL().subscribe(V=>{D(V)})})).subscribe()})}}return h.\u0275fac=function(a){return new(a||h)(r.LFG(g.Q1))},h.\u0275prov=r.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();var S=u(7904),x=u(7622),p=u(9972),Z=u(1618),Y=u(4755);function ne(h,j){if(1&h&&(r.TgZ(0,"ion-col",13),r._UZ(1,"ion-img",14),r.qZA()),2&h){const a=j.$implicit;r.xp6(1),r.Q6J("src",a.webviewPath)}}let oe=(()=>{class h{constructor(a,v,L,D,W,A,H){this.route=a,this.photoService=v,this.firestores=L,this.auth=D,this.router=W,this.loadingCtrl=A,this.toastServiceService=H,this.tipo="",this.newItem={},this.imageCargada="",this.newFile="",this.uploading=!1,this.alertButtons=[{text:"No",cssClass:"alert-button-cancel"},{text:"Yes",cssClass:"alert-button-confirm",handler:()=>this.cancelar()}],this.tipo=this.route.snapshot.paramMap.get("type"),this.newItem.tipo=this.tipo}ngOnInit(){}addPhotoToGallery(){this.photoService.addNewToGallery()}subirImagenes(){var a=this;return(0,l.Z)(function*(){a.uploading=!0;const v=yield a.loadingCtrl.create({spinner:"lines",cssClass:"custom-loading"});yield v.present();try{const L="Galeria";a.newItem.name=a.auth.myUsuario;for(const D of a.photoService.photos)if(D.webviewPath){const W=yield a.readAsBlob(D.webviewPath),A=a.generateFileName(),H=yield a.photoService.uploadImage(W,L,A);a.newItem.id=a.generateUniqueId(),a.newItem.image=H,a.newItem.fecha=(new Date).toLocaleDateString("es-ES");const V=yield a.firestores.addItem(a.newItem);console.log(V)}a.photoService.photos=[],a.toastServiceService.presentToast("Se cargo con exito","success")}catch(L){console.error(L),a.toastServiceService.presentToast("Error al subir las imagenes","danger")}finally{a.uploading=!1,yield v.dismiss()}})()}readAsBlob(a){return(0,l.Z)(function*(){return yield(yield fetch(a)).blob()})()}generateFileName(){return`${(new Date).getTime()}.jpg`}generateUniqueId(){return`${(new Date).getTime()}-${Math.floor(1e6*Math.random())}`}cancelar(){this.toastServiceService.presentToast("Eliminando fotos...","danger"),setTimeout(()=>{this.photoService.photos=[],this.router.navigate(["/tabs"])},2e3)}}return h.\u0275fac=function(a){return new(a||h)(r.Y36(_.gz),r.Y36(E),r.Y36(S.E),r.Y36(x.e),r.Y36(_.F0),r.Y36(p.HT),r.Y36(Z.L))},h.\u0275cmp=r.Xpm({type:h,selectors:[["app-camara"]],decls:19,vars:3,consts:[[3,"translucent"],["slot","start"],["defaultHref","/home"],["size","6",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","center","slot","fixed"],["color","tertiary",3,"click"],["name","camera"],["vertical","bottom","horizontal","end","slot","fixed"],["color","success",3,"click"],["name","cloud-upload-outline"],["vertical","bottom","horizontal","start","slot","fixed"],["id","present-toast","color","danger",3,"click"],["name","close-outline"],["size","6"],[3,"src"]],template:function(a,v){1&a&&(r.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),r._uU(3),r.qZA(),r.TgZ(4,"ion-buttons",1),r._UZ(5,"ion-back-button",2),r.qZA()()(),r.TgZ(6,"ion-content")(7,"ion-grid")(8,"ion-row"),r.YNc(9,ne,2,1,"ion-col",3),r.qZA()(),r.TgZ(10,"ion-fab",4)(11,"ion-fab-button",5),r.NdJ("click",function(){return v.addPhotoToGallery()}),r._UZ(12,"ion-icon",6),r.qZA()(),r.TgZ(13,"ion-fab",7)(14,"ion-fab-button",8),r.NdJ("click",function(){return v.subirImagenes()}),r._UZ(15,"ion-icon",9),r.qZA()(),r.TgZ(16,"ion-fab",10)(17,"ion-fab-button",11),r.NdJ("click",function(){return v.cancelar()}),r._UZ(18,"ion-icon",12),r.qZA()()()),2&a&&(r.Q6J("translucent",!0),r.xp6(3),r.Oqu(v.tipo),r.xp6(6),r.Q6J("ngForOf",v.photoService.photos))},dependencies:[Y.sg,p.oU,p.Sm,p.wI,p.W2,p.IJ,p.W4,p.jY,p.Gu,p.gu,p.Xz,p.Nd,p.wd,p.sr,p.cs],styles:["ion-alert.custom-alert[_ngcontent-%COMP%]{--backdrop-opacity: .7}.custom-alert[_ngcontent-%COMP%]   .alert-button-group[_ngcontent-%COMP%]{padding:8px}.custom-loading[_ngcontent-%COMP%]   .loading-wrapper[_ngcontent-%COMP%]{align-items:center;justify-content:center;background-color:transparent}button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{background-color:var(--ion-color-success);color:var(--ion-color-success-contrast)}.md[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-radius:4px}.ios[_ngcontent-%COMP%]   .custom-alert[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{border:.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0),.2)}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-cancel[_ngcontent-%COMP%]{border-right:0;border-bottom-left-radius:13px;border-top-left-radius:13px}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-bottom-right-radius:13px;border-top-right-radius:13px}ion-content[_ngcontent-%COMP%]{--background:#548bae}ion-toolbar[_ngcontent-%COMP%]{--background: #090A0B;color:#f0f8ff}"]}),h})()},7904:(N,M,u)=>{u.d(M,{E:()=>k});var l=u(5861),r=u(89),_=u(2223);let k=(()=>{class C{constructor(m){this.firestore=m}addItem(m){const g=(0,r.hJ)(this.firestore,"relevamiento");return(0,r.ET)(g,m)}getAllItems(){var m=this;return(0,l.Z)(function*(){const g=(0,r.hJ)(m.firestore,"relevamiento"),E=yield(0,r.PL)((0,r.IO)(g,(0,r.Xo)("fecha","desc"))),S=[];return E.forEach(x=>{const p=x.data();S.push(p)}),S})()}getAllItemsType(m){var g=this;return(0,l.Z)(function*(){const E=(0,r.hJ)(g.firestore,"relevamiento"),S=yield(0,r.PL)((0,r.IO)(E,(0,r.ar)("tipo","==",m)));console.log(S);const x=[];return S.forEach(p=>{const Z=p.data();x.push(Z)}),x})()}updateItem(m){var g=this;return(0,l.Z)(function*(){const E=(0,r.JU)(g.firestore,"relevamiento",m.id);yield(0,r.pl)(E,m,{merge:!0})})()}}return C.\u0275fac=function(m){return new(m||C)(_.LFG(r.gg))},C.\u0275prov=_.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},1618:(N,M,u)=>{u.d(M,{L:()=>k});var l=u(5861),r=u(2223),_=u(9972);let k=(()=>{class C{constructor(m){this.toastController=m}presentToast(m,g){var E=this;return(0,l.Z)(function*(){yield(yield E.toastController.create({message:m,duration:2e3,color:g})).present()})()}}return C.\u0275fac=function(m){return new(m||C)(r.LFG(_.yF))},C.\u0275prov=r.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()}}]);