"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[579],{76:(N,Z,u)=>{u.d(Z,{GW:()=>r,dk:()=>P,oK:()=>s});var s=(()=>((s=s||{}).Prompt="PROMPT",s.Camera="CAMERA",s.Photos="PHOTOS",s))(),r=(()=>((r=r||{}).Rear="REAR",r.Front="FRONT",r))(),P=(()=>((P=P||{}).Uri="uri",P.Base64="base64",P.DataUrl="dataUrl",P))()},7423:(N,Z,u)=>{u.d(Z,{Uw:()=>h,fo:()=>A,xz:()=>d});var s=u(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var O=(()=>((O=O||{}).Unimplemented="UNIMPLEMENTED",O.Unavailable="UNAVAILABLE",O))();class d extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const L=n=>{var e,t,i,c,o;const m=n.CapacitorCustomPlatform||null,l=n.Capacitor||{},y=l.Plugins=l.Plugins||{},g=n.CapacitorPlatforms,z=(null===(e=null==g?void 0:g.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==m?m.name:(n=>{var e,t;return null!=n&&n.androidBridge?"android":null!==(t=null===(e=null==n?void 0:n.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(n)),ce=(null===(t=null==g?void 0:g.currentPlatform)||void 0===t?void 0:t.isNativePlatform)||(()=>"web"!==z()),de=(null===(i=null==g?void 0:g.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(p=>{const b=te.get(p);return!!(null!=b&&b.platforms.has(z())||ae(p))}),ae=(null===(c=null==g?void 0:g.currentPlatform)||void 0===c?void 0:c.getPluginHeader)||(p=>{var b;return null===(b=l.PluginHeaders)||void 0===b?void 0:b.find(J=>J.name===p)}),te=new Map,ve=(null===(o=null==g?void 0:g.currentPlatform)||void 0===o?void 0:o.registerPlugin)||((p,b={})=>{const J=te.get(p);if(J)return console.warn(`Capacitor plugin "${p}" already registered. Cannot register plugins twice.`),J.proxy;const B=z(),Y=ae(p);let x;const pe=function(){var _=(0,s.Z)(function*(){return!x&&B in b?x=x="function"==typeof b[B]?yield b[B]():b[B]:null!==m&&!x&&"web"in b&&(x=x="function"==typeof b.web?yield b.web():b.web),x});return function(){return _.apply(this,arguments)}}(),re=_=>{let E;const I=(...$)=>{const D=pe().then(M=>{const G=((_,E)=>{var I,$;if(!Y){if(_)return null===($=_[E])||void 0===$?void 0:$.bind(_);throw new d(`"${p}" plugin is not implemented on ${B}`,O.Unimplemented)}{const D=null==Y?void 0:Y.methods.find(M=>E===M.name);if(D)return"promise"===D.rtype?M=>l.nativePromise(p,E.toString(),M):(M,G)=>l.nativeCallback(p,E.toString(),M,G);if(_)return null===(I=_[E])||void 0===I?void 0:I.bind(_)}})(M,_);if(G){const q=G(...$);return E=null==q?void 0:q.remove,q}throw new d(`"${p}.${_}()" is not implemented on ${B}`,O.Unimplemented)});return"addListener"===_&&(D.remove=(0,s.Z)(function*(){return E()})),D};return I.toString=()=>`${_.toString()}() { [capacitor code] }`,Object.defineProperty(I,"name",{value:_,writable:!1,configurable:!1}),I},se=re("addListener"),le=re("removeListener"),Pe=(_,E)=>{const I=se({eventName:_},E),$=function(){var M=(0,s.Z)(function*(){const G=yield I;le({eventName:_,callbackId:G},E)});return function(){return M.apply(this,arguments)}}(),D=new Promise(M=>I.then(()=>M({remove:$})));return D.remove=(0,s.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield $()}),D},ne=new Proxy({},{get(_,E){switch(E){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Y?Pe:se;case"removeListener":return le;default:return re(E)}}});return y[p]=ne,te.set(p,{name:p,proxy:ne,platforms:new Set([...Object.keys(b),...Y?[B]:[]])}),ne});return l.convertFileSrc||(l.convertFileSrc=p=>p),l.getPlatform=z,l.handleError=p=>n.console.error(p),l.isNativePlatform=ce,l.isPluginAvailable=de,l.pluginMethodNoop=(p,b,J)=>Promise.reject(`${J} does not have an implementation of "${b}".`),l.registerPlugin=ve,l.Exception=d,l.DEBUG=!!l.DEBUG,l.isLoggingEnabled=!!l.isLoggingEnabled,l.platform=l.getPlatform(),l.isNative=l.isNativePlatform(),l},S=(n=>n.Capacitor=L(n))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),A=S.registerPlugin;class h{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){var i=this;this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o);const m=function(){var y=(0,s.Z)(function*(){return i.removeListener(e,t)});return function(){return y.apply(this,arguments)}}(),l=Promise.resolve({remove:m});return Object.defineProperty(l,"remove",{value:(y=(0,s.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield m()}),function(){return y.apply(this,arguments)})}),l;var y}removeAllListeners(){var e=this;return(0,s.Z)(function*(){e.listeners={};for(const t in e.windowListeners)e.removeWindowListener(e.windowListeners[t]);e.windowListeners={}})()}notifyListeners(e,t){const i=this.listeners[e];i&&i.forEach(c=>c(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new S.Exception(e,O.Unimplemented)}unavailable(e="not available"){return new S.Exception(e,O.Unavailable)}removeListener(e,t){var i=this;return(0,s.Z)(function*(){const c=i.listeners[e];if(!c)return;const o=c.indexOf(t);i.listeners[e].splice(o,1),i.listeners[e].length||i.removeWindowListener(i.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const a=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),v=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class U extends h{getCookies(){return(0,s.Z)(function*(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[c,o]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=v(c).trim(),o=v(o).trim(),t[c]=o}),t})()}setCookie(e){return(0,s.Z)(function*(){try{const t=a(e.key),i=a(e.value),c=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),m=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${c}; path=${o}; ${m};`}catch(t){return Promise.reject(t)}})()}deleteCookie(e){return(0,s.Z)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})()}clearCookies(){return(0,s.Z)(function*(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,s.Z)(function*(){try{yield e.clearCookies()}catch(t){return Promise.reject(t)}})()}}A("CapacitorCookies",{web:()=>new U});const F=function(){var n=(0,s.Z)(function*(e){return new Promise((t,i)=>{const c=new FileReader;c.onload=()=>{const o=c.result;t(o.indexOf(",")>=0?o.split(",")[1]:o)},c.onerror=o=>i(o),c.readAsDataURL(e)})});return function(t){return n.apply(this,arguments)}}();class ie extends h{request(e){return(0,s.Z)(function*(){const t=((n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),c=((n={})=>{const e=Object.keys(n);return Object.keys(n).map(c=>c.toLocaleLowerCase()).reduce((c,o,m)=>(c[o]=n[e[m]],c),{})})(n.headers)["content-type"]||"";if("string"==typeof n.data)t.body=n.data;else if(c.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[m,l]of Object.entries(n.data||{}))o.set(m,l);t.body=o.toString()}else if(c.includes("multipart/form-data")){const o=new FormData;if(n.data instanceof FormData)n.data.forEach((l,y)=>{o.append(y,l)});else for(const l of Object.keys(n.data))o.append(l,n.data[l]);t.body=o;const m=new Headers(t.headers);m.delete("content-type"),t.headers=m}else(c.includes("application/json")||"object"==typeof n.data)&&(t.body=JSON.stringify(n.data));return t})(e,e.webFetchExtra),i=((n,e=!0)=>n?Object.entries(n).reduce((i,c)=>{const[o,m]=c;let l,y;return Array.isArray(m)?(y="",m.forEach(g=>{l=e?encodeURIComponent(g):g,y+=`${o}=${l}&`}),y.slice(0,-1)):(l=e?encodeURIComponent(m):m,y=`${o}=${l}`),`${i}&${y}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),c=i?`${e.url}?${i}`:e.url,o=yield fetch(c,t),m=o.headers.get("content-type")||"";let y,g,{responseType:l="text"}=o.ok?e:{};switch(m.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":g=yield o.blob(),y=yield F(g);break;case"json":y=yield o.json();break;default:y=yield o.text()}const X={};return o.headers.forEach((z,ee)=>{X[ee]=z}),{data:y,headers:X,status:o.status,url:o.url}})()}get(e){var t=this;return(0,s.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var t=this;return(0,s.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var t=this;return(0,s.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var t=this;return(0,s.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var t=this;return(0,s.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}A("CapacitorHttp",{web:()=>new ie})},3676:(N,Z,u)=>{u.d(Z,{q:()=>oe});var s=u(5861),r=u(2223),P=u(5559),k=u(7423),T=u(76);const K=(0,k.fo)("Camera",{web:()=>u.e(3954).then(u.bind(u,3954)).then(h=>new h.CameraWeb)});var C=u(8746),O=u(377);let d=(()=>{class h{constructor(a){this.storage=a,this.photos=[]}addNewToGallery(){var a=this;return(0,s.Z)(function*(){const v=yield K.getPhoto({resultType:T.dk.Uri,source:T.oK.Camera,quality:100});a.photos.unshift({filepath:`${(new Date).getTime()}.jpg`,webviewPath:v.webPath})})()}uploadImage(a,v,U){return new Promise(W=>{const R=this.storage.ref(v+"/"+U);R.put(a).snapshotChanges().pipe((0,C.x)(()=>{R.getDownloadURL().subscribe(V=>{W(V)})})).subscribe()})}}return h.\u0275fac=function(a){return new(a||h)(r.LFG(O.Q1))},h.\u0275prov=r.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();var w=u(7904),L=u(7622),f=u(9972),S=u(1618),A=u(4755);function Q(h,j){if(1&h&&(r.TgZ(0,"ion-col",13),r._UZ(1,"ion-img",14),r.qZA()),2&h){const a=j.$implicit;r.xp6(1),r.Q6J("src",a.webviewPath)}}let oe=(()=>{class h{constructor(a,v,U,W,F,R,H){this.route=a,this.photoService=v,this.firestores=U,this.auth=W,this.router=F,this.loadingCtrl=R,this.toastServiceService=H,this.tipo="",this.newItem={},this.imageCargada="",this.newFile="",this.uploading=!1,this.alertButtons=[{text:"No",cssClass:"alert-button-cancel"},{text:"Yes",cssClass:"alert-button-confirm",handler:()=>this.cancelar()}],this.tipo=this.route.snapshot.paramMap.get("type"),this.newItem.tipo=this.tipo}ngOnInit(){}addPhotoToGallery(){this.photoService.addNewToGallery()}subirImagenes(){var a=this;return(0,s.Z)(function*(){a.uploading=!0;const v=yield a.loadingCtrl.create({spinner:"lines",cssClass:"custom-loading"});yield v.present();try{const U="Galeria";a.newItem.name=a.auth.myUsuario;for(const W of a.photoService.photos)if(W.webviewPath){const F=yield a.readAsBlob(W.webviewPath),R=a.generateFileName(),H=yield a.photoService.uploadImage(F,U,R);a.newItem.id=a.generateUniqueId(),a.newItem.image=H,a.newItem.fecha=(new Date).toLocaleDateString("es-ES");const V=yield a.firestores.addItem(a.newItem);console.log(V)}a.photoService.photos=[],a.toastServiceService.presentToast("Se cargo con exito","success")}catch(U){console.error(U),a.toastServiceService.presentToast("Error al subir las imagenes","danger")}finally{a.uploading=!1,yield v.dismiss()}})()}readAsBlob(a){return(0,s.Z)(function*(){return yield(yield fetch(a)).blob()})()}generateFileName(){return`${(new Date).getTime()}.jpg`}generateUniqueId(){return`${(new Date).getTime()}-${Math.floor(1e6*Math.random())}`}cancelar(){this.toastServiceService.presentToast("Eliminando fotos...","danger"),setTimeout(()=>{this.photoService.photos=[],this.router.navigate(["/tabs"])},2e3)}}return h.\u0275fac=function(a){return new(a||h)(r.Y36(P.gz),r.Y36(d),r.Y36(w.E),r.Y36(L.e),r.Y36(P.F0),r.Y36(f.HT),r.Y36(S.L))},h.\u0275cmp=r.Xpm({type:h,selectors:[["app-camara"]],decls:19,vars:3,consts:[[3,"translucent"],["slot","start"],["defaultHref","/home"],["size","6",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","center","slot","fixed"],["color","tertiary",3,"click"],["name","camera"],["vertical","bottom","horizontal","end","slot","fixed"],["color","success",3,"click"],["name","cloud-upload-outline"],["vertical","bottom","horizontal","start","slot","fixed"],["id","present-toast","color","danger",3,"click"],["name","close-outline"],["size","6"],[3,"src"]],template:function(a,v){1&a&&(r.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),r._uU(3),r.qZA(),r.TgZ(4,"ion-buttons",1),r._UZ(5,"ion-back-button",2),r.qZA()()(),r.TgZ(6,"ion-content")(7,"ion-grid")(8,"ion-row"),r.YNc(9,Q,2,1,"ion-col",3),r.qZA()(),r.TgZ(10,"ion-fab",4)(11,"ion-fab-button",5),r.NdJ("click",function(){return v.addPhotoToGallery()}),r._UZ(12,"ion-icon",6),r.qZA()(),r.TgZ(13,"ion-fab",7)(14,"ion-fab-button",8),r.NdJ("click",function(){return v.subirImagenes()}),r._UZ(15,"ion-icon",9),r.qZA()(),r.TgZ(16,"ion-fab",10)(17,"ion-fab-button",11),r.NdJ("click",function(){return v.cancelar()}),r._UZ(18,"ion-icon",12),r.qZA()()()),2&a&&(r.Q6J("translucent",!0),r.xp6(3),r.Oqu(v.tipo),r.xp6(6),r.Q6J("ngForOf",v.photoService.photos))},dependencies:[A.sg,f.oU,f.Sm,f.wI,f.W2,f.IJ,f.W4,f.jY,f.Gu,f.gu,f.Xz,f.Nd,f.wd,f.sr,f.cs],styles:["ion-alert.custom-alert[_ngcontent-%COMP%]{--backdrop-opacity: .7}.custom-alert[_ngcontent-%COMP%]   .alert-button-group[_ngcontent-%COMP%]{padding:8px}.custom-loading[_ngcontent-%COMP%]   .loading-wrapper[_ngcontent-%COMP%]{align-items:center;justify-content:center;background-color:transparent}button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{background-color:var(--ion-color-success);color:var(--ion-color-success-contrast)}.md[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-radius:4px}.ios[_ngcontent-%COMP%]   .custom-alert[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{border:.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0),.2)}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-cancel[_ngcontent-%COMP%]{border-right:0;border-bottom-left-radius:13px;border-top-left-radius:13px}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-bottom-right-radius:13px;border-top-right-radius:13px}ion-content[_ngcontent-%COMP%]{--background:#548bae}ion-toolbar[_ngcontent-%COMP%]{--background: #090A0B;color:#f0f8ff}"]}),h})()},7904:(N,Z,u)=>{u.d(Z,{E:()=>K});var s=u(5861),r=u(89),P=u(2223),k=u(7622),T=u(5197);let K=(()=>{class C{constructor(d,w,L){this.firestore=d,this.authService=w,this.db=L;const f=(0,r.hJ)(this.firestore,"relevamiento");this.items$=(0,r.BS)(f)}getUsers(){var d=this;return(0,s.Z)(function*(){return d.db.list("users").valueChanges()})()}addItem(d){var w=this;return(0,s.Z)(function*(){const L=(0,r.hJ)(w.firestore,"relevamiento");return(0,r.ET)(L,d)})()}getAllItems(){var d=this;return(0,s.Z)(function*(){const w=(0,r.hJ)(d.firestore,"relevamiento"),L=yield(0,r.PL)((0,r.IO)(w,(0,r.Xo)("fecha","desc"))),f=[];return L.forEach(S=>{const A=S.data();f.push(A)}),f})()}getAllItemsType(d){var w=this;return(0,s.Z)(function*(){const L=(0,r.hJ)(w.firestore,"relevamiento"),f=yield(0,r.PL)((0,r.IO)(L,(0,r.ar)("tipo","==",d)));console.log(f);const S=[];return f.forEach(A=>{const Q=A.data();S.push(Q)}),S})()}updateItem(d){var w=this;return(0,s.Z)(function*(){const L=(0,r.JU)(w.firestore,"relevamiento",d.id);yield(0,r.pl)(L,d,{merge:!0})})()}voteForPhoto(d){var w=this;return(0,s.Z)(function*(){w.firestore.toJSON.call("relevamiento")})()}}return C.\u0275fac=function(d){return new(d||C)(P.LFG(r.gg),P.LFG(k.e),P.LFG(T.KQ))},C.\u0275prov=P.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},1618:(N,Z,u)=>{u.d(Z,{L:()=>k});var s=u(5861),r=u(2223),P=u(9972);let k=(()=>{class T{constructor(C){this.toastController=C}presentToast(C,O){var d=this;return(0,s.Z)(function*(){yield(yield d.toastController.create({message:C,duration:2e3,color:O})).present()})()}}return T.\u0275fac=function(C){return new(C||T)(r.LFG(P.yF))},T.\u0275prov=r.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()}}]);