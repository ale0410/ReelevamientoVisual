"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9196],{7904:(y,T,s)=>{s.d(T,{E:()=>v});var d=s(5861),a=s(89),o=s(2223),p=s(7622),g=s(5197),e=s(1085);let v=(()=>{class f{constructor(i,r,l,h){this.firestore=i,this.authService=r,this.db=l,this.angFirestore=h;const m=(0,a.hJ)(this.firestore,"relevamiento");this.items$=(0,a.BS)(m)}savePhoto(i,r){const l=this.angFirestore.collection("fotos").doc(i);l.get().subscribe(h=>{h.exists?console.log("La foto ya existe en la base de datos"):(l.set({url:r,votos:0}),console.log("La foto se ha guardado en la base de datos"))})}getUsers(){var i=this;return(0,d.Z)(function*(){return i.db.list("users").valueChanges()})()}addItem(i){var r=this;return(0,d.Z)(function*(){const l=r.angFirestore.createId();return i.id=l,r.angFirestore.collection("relevamiento").doc(i.id).set(i)})()}getAllItems(){var i=this;return(0,d.Z)(function*(){const r=(0,a.hJ)(i.firestore,"relevamiento"),l=yield(0,a.PL)((0,a.IO)(r,(0,a.Xo)("fecha","desc"))),h=[];return l.forEach(m=>{const C=m.data();h.push(C)}),h})()}getAllItemsType(i){var r=this;return(0,d.Z)(function*(){const l=(0,a.hJ)(r.firestore,"relevamiento"),h=yield(0,a.PL)((0,a.IO)(l,(0,a.ar)("tipo","==",i)));console.log(h);const m=[];return h.forEach(C=>{const O=C.data();m.push(O)}),m})()}updateItem(i){var r=this;return(0,d.Z)(function*(){const l=(0,a.JU)(r.firestore,"relevamiento",i.id);yield(0,a.pl)(l,i)})()}voteForPhoto(i){var r=this;return(0,d.Z)(function*(){r.firestore.toJSON.call("relevamiento")})()}}return f.\u0275fac=function(i){return new(i||f)(o.LFG(a.gg),o.LFG(p.e),o.LFG(g.KQ),o.LFG(e.ST))},f.\u0275prov=o.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},1618:(y,T,s)=>{s.d(T,{L:()=>p});var d=s(5861),a=s(2223),o=s(9972);let p=(()=>{class g{constructor(v){this.toastController=v}presentToast(v,f){var P=this;return(0,d.Z)(function*(){yield(yield P.toastController.create({message:v,duration:2e3,color:f})).present()})()}}return g.\u0275fac=function(v){return new(v||g)(a.LFG(o.yF))},g.\u0275prov=a.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},9196:(y,T,s)=>{s.r(T),s.d(T,{Tab2PageModule:()=>x});var d=s(4755),a=s(5030),o=s(9972),p=s(5559),g=s(5861),e=s(2223),v=s(7622),f=s(7904),P=s(1618);function i(n,_){if(1&n&&(e.TgZ(0,"ion-item"),e._uU(1),e.qZA()),2&n){const t=_.$implicit;e.xp6(1),e.AsE(" ",t.name," - ",t.email," ")}}function r(n,_){if(1&n){const t=e.EpF();e.TgZ(0,"ion-card",11),e._UZ(1,"img",12),e.TgZ(2,"ion-card-header")(3,"ion-card-title",13),e._uU(4),e.TgZ(5,"ion-card-subtitle",14),e._uU(6),e.qZA()(),e.TgZ(7,"ion-card-subtitle",14),e._uU(8),e.qZA()(),e.TgZ(9,"ion-card-content")(10,"p"),e._uU(11),e.qZA()(),e.YNc(12,i,2,2,"ion-item",15),e.TgZ(13,"ion-chip",16),e.NdJ("click",function(){const b=e.CHM(t).$implicit,M=e.oxw(2);return e.KtG(M.votar(b))}),e._uU(14,"Votar"),e.qZA()()}if(2&n){const t=_.$implicit,c=e.oxw(2);e.xp6(1),e.Q6J("src",t.image,e.LSH),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Oqu(t.fecha),e.xp6(2),e.hij("Tipo: ",t.tipo,""),e.xp6(3),e.hij("Votos: ",null==t.votos?null:t.votos.length,""),e.xp6(1),e.Q6J("ngForOf",c.users),e.xp6(1),e.ekj("voted",t.votos)}}function l(n,_){if(1&n&&(e.TgZ(0,"ion-list",9),e.YNc(1,r,15,8,"ion-card",10),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.itemsAux)}}const m=[{path:"",component:(()=>{class n{constructor(t,c,u,b,M,F){this.router=t,this.loginService=c,this.firestoresService=u,this.loadingCtrl=b,this.toastServiceService=M,this.navController=F,this.items=[],this.uploading=!1}ngOnInit(){this.loginService.obtenerUsuario().then(t=>{this.user=null==t?void 0:t.uid,console.log(this.user)}),this.select="Cosas Lindas"}ionViewWillEnter(){this.getAllData()}logout(){this.loginService.signOut().then(()=>{this.router.navigate(["/login"])})}navegarCamara(t){this.navController.navigateForward("/camara/"+t)}getAllData(){var t=this;return(0,g.Z)(function*(){t.uploading=!0;const c=yield t.loadingCtrl.create({spinner:"lines",cssClass:"custom-loading"});yield c.present();try{t.items=yield t.firestoresService.getAllItems(),t.itemsAux=t.items.filter(u=>u.tipo==t.select),console.log(t.items)}catch(u){console.log("Error al obtener datos:",u)}finally{t.uploading=!1,yield c.dismiss()}})()}handleChange(t){this.select=t.target.value,this.getAllData()}votar(t){var c=this;return(0,g.Z)(function*(){if(t.votos){const u=c.YaVoto(t);console.log(u),u>-1?t.votos.splice(u,1):t.votos.push(c.user)}else t.votos=[c.user];yield c.firestoresService.updateItem(t)})()}YaVoto(t){return t.votos.findIndex(u=>u==this.user)}votePhoto(t){t.hasVoted?(t.votes--,t.hasVoted=!1):(t.votes++,t.hasVoted=!0)}formatFecha(t){return t.toLocaleDateString()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.F0),e.Y36(v.e),e.Y36(f.E),e.Y36(o.HT),e.Y36(P.L),e.Y36(o.SH))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tab2"]],decls:16,vars:3,consts:[[3,"translucent"],["slot","primary"],[3,"click"],["slot","icon-only","name","exit"],[3,"fullscreen"],["value","Cosas Lindas","interface","popover",3,"ionChange"],["value","Cosas Lindas"],["value","Cosas Feas"],["style","background-image: url('../../assets/images/floor.jpg');",4,"ngIf"],[2,"background-image","url('../../assets/images/floor.jpg')"],["class","custom-card",4,"ngFor","ngForOf"],[1,"custom-card"],["alt","Silhouette of mountains",3,"src"],[2,"color","#EFF3F5","display","flex","justify-content","space-between"],[2,"color","#C8CDD0"],[4,"ngFor","ngForOf"],[1,"custom-chip",3,"click"]],template:function(t,c){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),e.NdJ("click",function(){return c.logout()}),e._UZ(4,"ion-icon",3),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6," Cosas Lindas / Cosas Feas "),e.qZA()()(),e.TgZ(7,"ion-content",4)(8,"ion-list")(9,"ion-item")(10,"ion-select",5),e.NdJ("ionChange",function(b){return c.handleChange(b)}),e.TgZ(11,"ion-select-option",6),e._uU(12,"Cosas Lindas "),e.qZA(),e.TgZ(13,"ion-select-option",7),e._uU(14,"Cosas Feas "),e.qZA()()()(),e.YNc(15,l,2,1,"ion-list",8),e.qZA()),2&t&&(e.Q6J("translucent",!0),e.xp6(7),e.Q6J("fullscreen",!0),e.xp6(8),e.Q6J("ngIf",!c.uploading))},dependencies:[d.sg,d.O5,o.YG,o.Sm,o.PM,o.FN,o.Zi,o.tO,o.Dq,o.hM,o.W2,o.Gu,o.gu,o.Ie,o.q_,o.t9,o.n0,o.wd,o.sr,o.QI],styles:['@charset "UTF-8";.title[_ngcontent-%COMP%]{font-size:24px;font-family:Arial,sans-serif}.custom-card[_ngcontent-%COMP%]{margin-bottom:10px;background-color:#192229;border-radius:10px;box-shadow:9px 14px 13px -8px #3d3c3c}.card-item[_ngcontent-%COMP%]{align-items:center}.custom-chip[_ngcontent-%COMP%]{font-size:20px;padding:1.3rem;background-color:#20bd20}.voted[_ngcontent-%COMP%]{background-color:#6592f1}.voted[_ngcontent-%COMP%]   .photo.hasVoted[_ngcontent-%COMP%]{background-color:#add8e6}ion-content[_ngcontent-%COMP%]{--background: url(floor.08978e6a924b6e32.jpg)}ion-toolbar[_ngcontent-%COMP%]{--background: rgb(107, 9, 107);color:#f0f8ff}ion-header[_ngcontent-%COMP%]{background-color:gray}ion-select[_ngcontent-%COMP%]{background-color:#67f8f8d8}']}),n})()}];let C=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(m),p.Bz]}),n})();var O=s(581);let x=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,a.u5,o.Pc,O.e,C]}),n})()}}]);