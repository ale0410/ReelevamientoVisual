"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[579],{76:(Q,A,u)=>{u.d(A,{GW:()=>r,dk:()=>_,oK:()=>a});var a=(()=>((a=a||{}).Prompt="PROMPT",a.Camera="CAMERA",a.Photos="PHOTOS",a))(),r=(()=>((r=r||{}).Rear="REAR",r.Front="FRONT",r))(),_=(()=>((_=_||{}).Uri="uri",_.Base64="base64",_.DataUrl="dataUrl",_))()},7423:(Q,A,u)=>{u.d(A,{Uw:()=>h,fo:()=>T,xz:()=>I});var a=u(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var v=(()=>((v=v||{}).Unimplemented="UNIMPLEMENTED",v.Unavailable="UNAVAILABLE",v))();class I extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const p=o=>{var e,t,s,c,n;const m=o.CapacitorCustomPlatform||null,l=o.Capacitor||{},C=l.Plugins=l.Plugins||{},g=o.CapacitorPlatforms,Y=(null===(e=null==g?void 0:g.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==m?m.name:(o=>{var e,t;return null!=o&&o.androidBridge?"android":null!==(t=null===(e=null==o?void 0:o.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(o)),ce=(null===(t=null==g?void 0:g.currentPlatform)||void 0===t?void 0:t.isNativePlatform)||(()=>"web"!==Y()),de=(null===(s=null==g?void 0:g.currentPlatform)||void 0===s?void 0:s.isPluginAvailable)||(P=>{const y=re.get(P);return!!(null!=y&&y.platforms.has(Y())||se(P))}),se=(null===(c=null==g?void 0:g.currentPlatform)||void 0===c?void 0:c.getPluginHeader)||(P=>{var y;return null===(y=l.PluginHeaders)||void 0===y?void 0:y.find(V=>V.name===P)}),re=new Map,ve=(null===(n=null==g?void 0:g.currentPlatform)||void 0===n?void 0:n.registerPlugin)||((P,y={})=>{const V=re.get(P);if(V)return console.warn(`Capacitor plugin "${P}" already registered. Cannot register plugins twice.`),V.proxy;const G=Y(),N=se(P);let x;const pe=function(){var w=(0,a.Z)(function*(){return!x&&G in y?x=x="function"==typeof y[G]?yield y[G]():y[G]:null!==m&&!x&&"web"in y&&(x=x="function"==typeof y.web?yield y.web():y.web),x});return function(){return w.apply(this,arguments)}}(),oe=w=>{let E;const Z=(...$)=>{const D=pe().then(U=>{const K=((w,E)=>{var Z,$;if(!N){if(w)return null===($=w[E])||void 0===$?void 0:$.bind(w);throw new I(`"${P}" plugin is not implemented on ${G}`,v.Unimplemented)}{const D=null==N?void 0:N.methods.find(U=>E===U.name);if(D)return"promise"===D.rtype?U=>l.nativePromise(P,E.toString(),U):(U,K)=>l.nativeCallback(P,E.toString(),U,K);if(w)return null===(Z=w[E])||void 0===Z?void 0:Z.bind(w)}})(U,w);if(K){const ee=K(...$);return E=null==ee?void 0:ee.remove,ee}throw new I(`"${P}.${w}()" is not implemented on ${G}`,v.Unimplemented)});return"addListener"===w&&(D.remove=(0,a.Z)(function*(){return E()})),D};return Z.toString=()=>`${w.toString()}() { [capacitor code] }`,Object.defineProperty(Z,"name",{value:w,writable:!1,configurable:!1}),Z},ae=oe("addListener"),le=oe("removeListener"),Pe=(w,E)=>{const Z=ae({eventName:w},E),$=function(){var U=(0,a.Z)(function*(){const K=yield Z;le({eventName:w,callbackId:K},E)});return function(){return U.apply(this,arguments)}}(),D=new Promise(U=>Z.then(()=>U({remove:$})));return D.remove=(0,a.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield $()}),D},ne=new Proxy({},{get(w,E){switch(E){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return N?Pe:ae;case"removeListener":return le;default:return oe(E)}}});return C[P]=ne,re.set(P,{name:P,proxy:ne,platforms:new Set([...Object.keys(y),...N?[G]:[]])}),ne});return l.convertFileSrc||(l.convertFileSrc=P=>P),l.getPlatform=Y,l.handleError=P=>o.console.error(P),l.isNativePlatform=ce,l.isPluginAvailable=de,l.pluginMethodNoop=(P,y,V)=>Promise.reject(`${V} does not have an implementation of "${y}".`),l.registerPlugin=ve,l.Exception=I,l.DEBUG=!!l.DEBUG,l.isLoggingEnabled=!!l.isLoggingEnabled,l.platform=l.getPlatform(),l.isNative=l.isNativePlatform(),l},O=(o=>o.Capacitor=p(o))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),T=O.registerPlugin;class h{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){var s=this;this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);const m=function(){var C=(0,a.Z)(function*(){return s.removeListener(e,t)});return function(){return C.apply(this,arguments)}}(),l=Promise.resolve({remove:m});return Object.defineProperty(l,"remove",{value:(C=(0,a.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield m()}),function(){return C.apply(this,arguments)})}),l;var C}removeAllListeners(){var e=this;return(0,a.Z)(function*(){e.listeners={};for(const t in e.windowListeners)e.removeWindowListener(e.windowListeners[t]);e.windowListeners={}})()}notifyListeners(e,t){const s=this.listeners[e];s&&s.forEach(c=>c(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:s=>{this.notifyListeners(t,s)}}}unimplemented(e="not implemented"){return new O.Exception(e,v.Unimplemented)}unavailable(e="not available"){return new O.Exception(e,v.Unavailable)}removeListener(e,t){var s=this;return(0,a.Z)(function*(){const c=s.listeners[e];if(!c)return;const n=c.indexOf(t);s.listeners[e].splice(n,1),s.listeners[e].length||s.removeWindowListener(s.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const i=o=>encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),b=o=>o.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class S extends h{getCookies(){return(0,a.Z)(function*(){const e=document.cookie,t={};return e.split(";").forEach(s=>{if(s.length<=0)return;let[c,n]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=b(c).trim(),n=b(n).trim(),t[c]=n}),t})()}setCookie(e){return(0,a.Z)(function*(){try{const t=i(e.key),s=i(e.value),c=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),m=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${c}; path=${n}; ${m};`}catch(t){return Promise.reject(t)}})()}deleteCookie(e){return(0,a.Z)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})()}clearCookies(){return(0,a.Z)(function*(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,a.Z)(function*(){try{yield e.clearCookies()}catch(t){return Promise.reject(t)}})()}}T("CapacitorCookies",{web:()=>new S});const j=function(){var o=(0,a.Z)(function*(e){return new Promise((t,s)=>{const c=new FileReader;c.onload=()=>{const n=c.result;t(n.indexOf(",")>=0?n.split(",")[1]:n)},c.onerror=n=>s(n),c.readAsDataURL(e)})});return function(t){return o.apply(this,arguments)}}();class ie extends h{request(e){return(0,a.Z)(function*(){const t=((o,e={})=>{const t=Object.assign({method:o.method||"GET",headers:o.headers},e),c=((o={})=>{const e=Object.keys(o);return Object.keys(o).map(c=>c.toLocaleLowerCase()).reduce((c,n,m)=>(c[n]=o[e[m]],c),{})})(o.headers)["content-type"]||"";if("string"==typeof o.data)t.body=o.data;else if(c.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[m,l]of Object.entries(o.data||{}))n.set(m,l);t.body=n.toString()}else if(c.includes("multipart/form-data")){const n=new FormData;if(o.data instanceof FormData)o.data.forEach((l,C)=>{n.append(C,l)});else for(const l of Object.keys(o.data))n.append(l,o.data[l]);t.body=n;const m=new Headers(t.headers);m.delete("content-type"),t.headers=m}else(c.includes("application/json")||"object"==typeof o.data)&&(t.body=JSON.stringify(o.data));return t})(e,e.webFetchExtra),s=((o,e=!0)=>o?Object.entries(o).reduce((s,c)=>{const[n,m]=c;let l,C;return Array.isArray(m)?(C="",m.forEach(g=>{l=e?encodeURIComponent(g):g,C+=`${n}=${l}&`}),C.slice(0,-1)):(l=e?encodeURIComponent(m):m,C=`${n}=${l}`),`${s}&${C}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),c=s?`${e.url}?${s}`:e.url,n=yield fetch(c,t),m=n.headers.get("content-type")||"";let C,g,{responseType:l="text"}=n.ok?e:{};switch(m.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":g=yield n.blob(),C=yield j(g);break;case"json":C=yield n.json();break;default:C=yield n.text()}const q={};return n.headers.forEach((Y,te)=>{q[te]=Y}),{data:C,headers:q,status:n.status,url:n.url}})()}get(e){var t=this;return(0,a.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var t=this;return(0,a.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var t=this;return(0,a.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var t=this;return(0,a.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var t=this;return(0,a.Z)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}T("CapacitorHttp",{web:()=>new ie})},3676:(Q,A,u)=>{u.d(A,{q:()=>X});var a=u(5861),r=u(2223),_=u(5559),R=u(7423),L=u(76);const H=(0,R.fo)("Camera",{web:()=>u.e(3954).then(u.bind(u,3954)).then(h=>new h.CameraWeb)});var M=u(8746),v=u(377);let I=(()=>{class h{constructor(i){this.storage=i,this.photos=[]}addNewToGallery(){var i=this;return(0,a.Z)(function*(){const b=yield H.getPhoto({resultType:L.dk.Uri,source:L.oK.Camera,quality:100});i.photos.unshift({filepath:`${(new Date).getTime()}.jpg`,webviewPath:b.webPath})})()}uploadImage(i,b,S){return new Promise(W=>{const k=this.storage.ref(b+"/"+S);k.put(i).snapshotChanges().pipe((0,M.x)(()=>{k.getDownloadURL().subscribe(B=>{W(B)})})).subscribe()})}}return h.\u0275fac=function(i){return new(i||h)(r.LFG(v.Q1))},h.\u0275prov=r.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();var f=u(7904),p=u(7622),d=u(9972),O=u(1618),T=u(4755);function z(h,F){if(1&h&&(r.TgZ(0,"ion-col",13),r._UZ(1,"ion-img",14),r.qZA()),2&h){const i=F.$implicit;r.xp6(1),r.Q6J("src",i.webviewPath)}}let X=(()=>{class h{constructor(i,b,S,W,j,k,J,B){this.route=i,this.photoService=b,this.firestores=S,this.loginService=W,this.auth=j,this.router=k,this.loadingCtrl=J,this.toastServiceService=B,this.tipo="",this.newItem={},this.imageCargada="",this.newFile="",this.uploading=!1,this.alertButtons=[{text:"No",cssClass:"alert-button-cancel"},{text:"Yes",cssClass:"alert-button-confirm",handler:()=>this.cancelar()}],this.tipo=this.route.snapshot.paramMap.get("type"),this.newItem.tipo=this.tipo}ngOnInit(){this.loginService.obtenerUsuario().then(i=>{this.user=null==i?void 0:i.email,console.log(this.user)})}addPhotoToGallery(){this.photoService.addNewToGallery()}subirImagenes(){var i=this;return(0,a.Z)(function*(){i.uploading=!0;const b=yield i.loadingCtrl.create({spinner:"lines",cssClass:"custom-loading"});yield b.present();try{const S="Galeria";i.newItem.name=i.user;for(const W of i.photoService.photos)if(W.webviewPath){const j=yield i.readAsBlob(W.webviewPath),k=i.generateFileName(),J=yield i.photoService.uploadImage(j,S,k);i.newItem.id=i.generateUniqueId(),i.newItem.image=J,i.newItem.fecha=(new Date).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"});const B=yield i.firestores.addItem(i.newItem);console.log(B)}i.photoService.photos=[],i.toastServiceService.presentToast("Se cargo con exito","success")}catch(S){console.error(S),i.toastServiceService.presentToast("Error al subir las imagenes","danger")}finally{i.uploading=!1,yield b.dismiss()}})()}readAsBlob(i){return(0,a.Z)(function*(){return yield(yield fetch(i)).blob()})()}generateFileName(){return`${(new Date).getTime()}.jpg`}generateUniqueId(){return`${(new Date).getTime()}-${Math.floor(1e6*Math.random())}`}cancelar(){this.toastServiceService.presentToast("Eliminando fotos...","danger"),setTimeout(()=>{this.photoService.photos=[],this.router.navigate(["/tabs"])},2e3)}}return h.\u0275fac=function(i){return new(i||h)(r.Y36(_.gz),r.Y36(I),r.Y36(f.E),r.Y36(p.e),r.Y36(p.e),r.Y36(_.F0),r.Y36(d.HT),r.Y36(O.L))},h.\u0275cmp=r.Xpm({type:h,selectors:[["app-camara"]],decls:19,vars:3,consts:[[3,"translucent"],["slot","start"],["defaultHref","/home"],["size","6",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","center","slot","fixed"],["color","tertiary",3,"click"],["name","camera"],["vertical","bottom","horizontal","end","slot","fixed"],["color","success",3,"click"],["name","cloud-upload-outline"],["vertical","bottom","horizontal","start","slot","fixed"],["id","present-toast","color","danger",3,"click"],["name","close-outline"],["size","6"],[3,"src"]],template:function(i,b){1&i&&(r.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),r._uU(3),r.qZA(),r.TgZ(4,"ion-buttons",1),r._UZ(5,"ion-back-button",2),r.qZA()()(),r.TgZ(6,"ion-content")(7,"ion-grid")(8,"ion-row"),r.YNc(9,z,2,1,"ion-col",3),r.qZA()(),r.TgZ(10,"ion-fab",4)(11,"ion-fab-button",5),r.NdJ("click",function(){return b.addPhotoToGallery()}),r._UZ(12,"ion-icon",6),r.qZA()(),r.TgZ(13,"ion-fab",7)(14,"ion-fab-button",8),r.NdJ("click",function(){return b.subirImagenes()}),r._UZ(15,"ion-icon",9),r.qZA()(),r.TgZ(16,"ion-fab",10)(17,"ion-fab-button",11),r.NdJ("click",function(){return b.cancelar()}),r._UZ(18,"ion-icon",12),r.qZA()()()),2&i&&(r.Q6J("translucent",!0),r.xp6(3),r.Oqu(b.tipo),r.xp6(6),r.Q6J("ngForOf",b.photoService.photos))},dependencies:[T.sg,d.oU,d.Sm,d.wI,d.W2,d.IJ,d.W4,d.jY,d.Gu,d.gu,d.Xz,d.Nd,d.wd,d.sr,d.cs],styles:["ion-alert.custom-alert[_ngcontent-%COMP%]{--backdrop-opacity: .7}.custom-alert[_ngcontent-%COMP%]   .alert-button-group[_ngcontent-%COMP%]{padding:8px}.custom-loading[_ngcontent-%COMP%]   .loading-wrapper[_ngcontent-%COMP%]{align-items:center;justify-content:center;background-color:transparent}button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{background-color:var(--ion-color-success);color:var(--ion-color-success-contrast)}.md[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-radius:4px}.ios[_ngcontent-%COMP%]   .custom-alert[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{border:.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0),.2)}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-cancel[_ngcontent-%COMP%]{border-right:0;border-bottom-left-radius:13px;border-top-left-radius:13px}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-bottom-right-radius:13px;border-top-right-radius:13px}ion-content[_ngcontent-%COMP%]{--background:#548bae}ion-toolbar[_ngcontent-%COMP%]{--background: #090A0B;color:#f0f8ff}"]}),h})()},7904:(Q,A,u)=>{u.d(A,{E:()=>M});var a=u(5861),r=u(89),_=u(2223),R=u(7622),L=u(5197),H=u(1085);let M=(()=>{class v{constructor(f,p,d,O){this.firestore=f,this.authService=p,this.db=d,this.angFirestore=O;const T=(0,r.hJ)(this.firestore,"relevamiento");this.items$=(0,r.BS)(T)}savePhoto(f,p){const d=this.angFirestore.collection("fotos").doc(f);d.get().subscribe(O=>{O.exists?console.log("La foto ya existe en la base de datos"):(d.set({url:p,votos:0}),console.log("La foto se ha guardado en la base de datos"))})}getUsers(){var f=this;return(0,a.Z)(function*(){return f.db.list("users").valueChanges()})()}addItem(f){var p=this;return(0,a.Z)(function*(){const d=p.angFirestore.createId();return f.id=d,p.angFirestore.collection("relevamiento").doc(f.id).set(f)})()}getAllItems(){var f=this;return(0,a.Z)(function*(){const p=(0,r.hJ)(f.firestore,"relevamiento"),d=yield(0,r.PL)((0,r.IO)(p,(0,r.Xo)("fecha","desc"))),O=[];return d.forEach(T=>{const z=T.data();O.push(z)}),O})()}getAllItemsType(f){var p=this;return(0,a.Z)(function*(){const d=(0,r.hJ)(p.firestore,"relevamiento"),O=yield(0,r.PL)((0,r.IO)(d,(0,r.ar)("tipo","==",f)));console.log(O);const T=[];return O.forEach(z=>{const X=z.data();T.push(X)}),T})()}updateItem(f){var p=this;return(0,a.Z)(function*(){const d=(0,r.JU)(p.firestore,"relevamiento",f.id);yield(0,r.pl)(d,f)})()}voteForPhoto(f){var p=this;return(0,a.Z)(function*(){p.firestore.toJSON.call("relevamiento")})()}}return v.\u0275fac=function(f){return new(f||v)(_.LFG(r.gg),_.LFG(R.e),_.LFG(L.KQ),_.LFG(H.ST))},v.\u0275prov=_.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},1618:(Q,A,u)=>{u.d(A,{L:()=>R});var a=u(5861),r=u(2223),_=u(9972);let R=(()=>{class L{constructor(M){this.toastController=M}presentToast(M,v){var I=this;return(0,a.Z)(function*(){yield(yield I.toastController.create({message:M,duration:2e3,color:v})).present()})()}}return L.\u0275fac=function(M){return new(M||L)(r.LFG(_.yF))},L.\u0275prov=r.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})()}}]);